RewriteLocationResponseHeader GatewayFilter 工厂修改 Location 响应头的值，通常是为了去掉后台的特定细节。它需要 stripVersionMode、locationHeaderName、hostValue 和 protocolsRegex 参数。下面的清单配置了一个 RewriteLocationResponseHeader GatewayFilter。

_Example 47. application.yml_



```plain
spring:
  cloud:
    gateway:
      routes:
      - id: rewritelocationresponseheader_route
        uri: http://example.org
        filters:
        - RewriteLocationResponseHeader=AS_IN_REQUEST, Location, ,
```



例如，对于一个 POST [api.example.com/some/object/name](https://api.example.com/some/object/name) 的请求， Location 响应头值 [object-service.prod.example.net/v2/some/object/id](https://object-service.prod.example.net/v2/some/object/id) 被改写为 [api.example.com/some/object/id](https://api.example.com/some/object/id)。

stripVersionMode 参数有以下可能的值。NEVER_STRIP、AS_IN_REQUEST（默认）和 ALWAYS_STRIP。

+ NEVER_STRIP: 即使最初的请求路径不包含version，version也不会被剥离。
+ AS_IN_REQUEST: 只有当原始请求路径不包含version时，才会剥离version。
+ ALWAYS_STRIP: version 总是被剥离，即使原始请求路径包含version 。

hostValue 参数，如果提供的话，将用于替换响应的 Location 头的 host:port 部分。如果没有提供，则使用 Host 请求头的值。

protocolsRegex 参数必须是一个有效的 regex String，协议名称将与之匹配。如果没有匹配，过滤器不做任何事情。默认是 http|https|ftp|ftps。

