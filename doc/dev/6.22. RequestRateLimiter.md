RequestRateLimiter GatewayFilter 工厂使用 RateLimiter 实现来确定是否允许当前请求继续进行。如果不允许，就会返回 HTTP 429 - Too Many Requests（默认）的状态。

这个过滤器需要一个可选的 keyResolver 参数和特定于速率限制器的参数（在[本节后面](https://springdoc.cn/spring-cloud-gateway/#key-resolver-section)描述）。

keyResolver 是一个实现了 KeyResolver 接口的Bean。在配置中，使用SpEL来引用Bean的名字。#{@myKeyResolver}是一个SpEL表达式，它引用了一个名为 myKeyResolver 的bean。下面的列表显示了 KeyResolver 的接口。

_Example 42. KeyResolver.java_



```plain
public interface KeyResolver {
    Mono<String> resolve(ServerWebExchange exchange);
}
```



KeyResolver 接口让可插拔的策略导出限制请求的key。在未来的里程碑版本中，会有一些 KeyResolver 的实现。

KeyResolver 的默认实现是 PrincipalNameKeyResolver，它从 ServerWebExchange 中检索 Principal 并调用 Principal.getName()。

默认情况下，如果 KeyResolver 没有找到一个 key，请求会被拒绝。你可以通过设置 spring.cloud.gateway.filter.request-rate-limiter.deny-empty-key（true 或 false）和 spring.cloud.gateway.filter.request-rate-limiter.empty-key-status-code 属性来调整这种行为。

| RequestRateLimiter 不能用 "快捷方式" 来配置。下面的例子是无效的。<br/>_Example 43. application.properties_ |
| --- |


# 无效的快捷方式配置 spring.cloud.gateway.routes[0].filters[0]=RequestRateLimiter=2, 2, #{@userkeyresolver}

